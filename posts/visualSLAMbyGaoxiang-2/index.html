<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>visual SLAM by Gaoxiang(2) | 自拙集</title><meta name="keywords" content="visual SLAM,Linux,C++11,Computer vision,Eigen"><meta name="author" content="Richard YU"><meta name="copyright" content="Richard YU"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="本次课程主要研究三维空间刚体运动，即visual slam的运动方程中的$x_{k}$如何表达。 点与坐标系在2D情况下，物体可以通过两个坐标和一个旋转角进行表达，即$(x,y,\theta)$。  在3D情况下，物体是6自由度的，包括平移和旋转，每个都得用三个变量表达，可以认为3D情况是包含着3个2D的情况，旋转轴不同。">
<meta property="og:type" content="article">
<meta property="og:title" content="visual SLAM by Gaoxiang(2)">
<meta property="og:url" content="http://densecollections.top/posts/visualSLAMbyGaoxiang-2/index.html">
<meta property="og:site_name" content="自拙集">
<meta property="og:description" content="本次课程主要研究三维空间刚体运动，即visual slam的运动方程中的$x_{k}$如何表达。 点与坐标系在2D情况下，物体可以通过两个坐标和一个旋转角进行表达，即$(x,y,\theta)$。  在3D情况下，物体是6自由度的，包括平移和旋转，每个都得用三个变量表达，可以认为3D情况是包含着3个2D的情况，旋转轴不同。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://images.unsplash.com/photo-1608488426085-c8b7e9e4592f?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=1351&q=80">
<meta property="article:published_time" content="2019-03-12T13:04:11.000Z">
<meta property="article:modified_time" content="2021-01-02T12:18:34.707Z">
<meta property="article:author" content="Richard YU">
<meta property="article:tag" content="visual SLAM">
<meta property="article:tag" content="Linux">
<meta property="article:tag" content="C++11">
<meta property="article:tag" content="Computer vision">
<meta property="article:tag" content="Eigen">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://images.unsplash.com/photo-1608488426085-c8b7e9e4592f?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=1351&q=80"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://densecollections.top/posts/visualSLAMbyGaoxiang-2/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="preconnect" href="//zz.bdstatic.com"/><link rel="manifest" href="/image/pwa/manifest.json"/><link rel="apple-touch-icon" sizes="180x180" href="/image/pwa/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/image/pwa/32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/image/pwa/16.png"/><link rel="mask-icon" href="/image/pwa/safari-pinned-tab.svg" color="#5bbad5"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: Richard YU","link":"链接: ","source":"来源: 自拙集","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}

// https://stackoverflow.com/questions/16839698/jquery-getscript-alternative-in-native-javascript
const getScript = url => new Promise((resolve, reject) => {
  const script = document.createElement('script')
  script.src = url
  script.async = true
  script.onerror = reject
  script.onload = script.onreadystatechange = function() {
    const loadState = this.readyState
    if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
    script.onload = script.onreadystatechange = null
    resolve()
  }
  document.head.appendChild(script)
})</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: true,
  isToc: true,
  postUpdate: '2021-01-02 20:18:34'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}})()</script><style type="text/css">.app-refresh{position:fixed;top:-2.2rem;left:0;right:0;z-index:99999;padding:0 1rem;font-size:15px;height:2.2rem;transition:all .3s ease}.app-refresh-wrap{display:flex;color:#fff;height:100%;align-items:center;justify-content:center}.app-refresh-wrap a{color:#fff;text-decoration:underline;cursor:pointer}</style><meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/atom.xml" title="自拙集" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/Richardyu114/PicBed_blog/others/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">25</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">54</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">12</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="/PaperStation/"><i class="fa-fw fas fa-edit"></i><span> PaperStation</span></a></div><div class="menus_item"><a class="site-page" href="/MindWandering/"><i class="fa-fw fas fa-paper-plane"></i><span> MindWandering</span></a></div></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://images.unsplash.com/photo-1608488426085-c8b7e9e4592f?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&amp;ixlib=rb-1.2.1&amp;auto=format&amp;fit=crop&amp;w=1351&amp;q=80)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">自拙集</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="/PaperStation/"><i class="fa-fw fas fa-edit"></i><span> PaperStation</span></a></div><div class="menus_item"><a class="site-page" href="/MindWandering/"><i class="fa-fw fas fa-paper-plane"></i><span> MindWandering</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">visual SLAM by Gaoxiang(2)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2019-03-12T13:04:11.000Z" title="发表于 2019-03-12 21:04:11">2019-03-12</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-01-02T12:18:34.707Z" title="更新于 2021-01-02 20:18:34">2021-01-02</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%A7%91%E7%A0%94%E8%AE%B0%E5%BD%95/">科研记录</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">6.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>28分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>本次课程主要研究<strong>三维空间刚体运动</strong>，即visual slam的运动方程中的$x_{k}$如何表达。</p>
<h2 id="点与坐标系"><a href="#点与坐标系" class="headerlink" title="点与坐标系"></a>点与坐标系</h2><p>在2D情况下，物体可以通过两个坐标和一个旋转角进行表达，即$(x,y,\theta)$。</p>
<p> 在3D情况下，物体是6自由度的，包括平移和旋转，每个都得用三个变量表达，可以认为3D情况是包含着3个2D的情况，旋转轴不同。                </p>
<a id="more"></a>
<p>理清坐标系（参考系），点，向量，向量的坐标，运动变换之间的关系。相机会有相机坐标系，机器人会有机体坐标系（通常是运动的），空间会有世界坐标系（通常是固定的），这都是为了研究问题的方便，通过变换进行运动的表述。</p>
<p>熟悉向量的相关运算规则，比如，向量的加减法，向量的内积和外积。以及向量和矩阵的关系。</p>
<script type="math/tex; mode=display">
\begin{align*}
& 内积： \bf{a} \cdot \bf{b} =\bf{a^{T}} \bf{b}=\sum_{i=1}^{n}=|\bf{a}||\bf{b}| \cos \left< \bf{a}, \bf{b}\right> \\

&外积： \bf{a} \times \bf{b}=
\begin{bmatrix}
\bf{i} & \bf{j} & \bf{k} \\
a_{1} & a_{2} & a_{3} \\
b_{1} & b_{2} & b_{3}
\end{bmatrix}
=
\begin{bmatrix}
a_{2}b_{3}-a_{3}b_{2}\\
a_{3}b_{1}-a_{1}b_{3}\\
a_{1}b_{2}-a_{2}b_{1}
\end{bmatrix}
=
\begin{bmatrix}
0 & -a_{3} & a_{2}\\
a_{3} & 0 & -a_{1} \\
-a_{2} & a_{1} & 0
\end{bmatrix}
\bf{b} \triangleq \bf{a} ^{\wedge} \bf{b}
\end{align*}</script><p>建立了坐标系之后，如何表示同一个向量在不同坐标系之间的坐标，坐标系之间的变换关系又该如何描述。坐标系之间的变换可以分解成坐标系原点之间之间的平移和坐标轴之间的旋转，那么可以用一个平移向量和旋转矩阵来描述这样的变换。我们知道矩阵可以表述坐标系之间的变换，对于三维空间而言，可以用一个$4 \times 4$的矩阵来描述三维坐标系之间的变换，这也就是平移向量和旋转矩阵的合成矩阵，具体后面会细说。</p>
<h2 id="旋转矩阵"><a href="#旋转矩阵" class="headerlink" title="旋转矩阵"></a>旋转矩阵</h2><p>一个向量在坐标系进行旋转后不变，因此可以通过此推导出旋转矩阵$R$的表达式（即用变换前后的坐标系的基向量进行表述）。</p>
<script type="math/tex; mode=display">
\begin{bmatrix}
a_{1}\\
a_{2}\\
a_{3}
\end{bmatrix}
=
\begin{bmatrix}
e_{1}^{T}e_{1}^{'} & e_{1}^{T}e_{2}^{'} & e_{1}^{T}e_{3}^{'}\\
e_{2}^{T}e_{1}^{'} & e_{2}^{T}e_{2}^{'} & e_{2}^{T}e_{3}^{'}\\
e_{3}^{T}e_{1}^{'} & e_{3}^{T}e_{2}^{'} & e_{3}^{T}e_{3}^{'}
\end{bmatrix}
\begin{bmatrix}
a_{1}^{'}\\
a_{2}^{'}\\
a_{3}^{'}
\end{bmatrix}
\triangleq R {\bf a}^{'}</script><p>旋转矩阵是正交矩阵（$RR^{T}=I$），且行列式为1（$\det (R)=1$）。旋转矩阵属于特殊正交群special orthogonal group，即：</p>
<script type="math/tex; mode=display">
SO(n) = \lbrace R \in \mathbb{R}^{n \times n} | RR^{T}=I, \det(R)=1 \rbrace</script><p>对一个旋转矩阵进行转置就描述了一个相反方向的旋转。</p>
<p>欧拉旋转定理（Euler’s rotation theorem）：刚体在三维空间里的一般运动，可分解为刚体上方某一点的平移，以及绕经过此点的旋转轴的转动。</p>
<script type="math/tex; mode=display">
{\bf a^{'}}= R \bf{a} + \bf{t}</script><p> 齐次形式（homogeneous）来更方便地表达变换，因为加上平移不满足线性性。定义变换矩阵$T$</p>
<script type="math/tex; mode=display">
\begin{bmatrix}
a^{'}\\
1
\end{bmatrix}
=
\begin{bmatrix}
R & \bf{t}\\
\bf{ 0^{T} } & 1
\end{bmatrix}
\begin{bmatrix}
a \\
1
\end{bmatrix}
\triangleq T
\begin{bmatrix}
a\\
1
\end{bmatrix}</script><p>齐次坐标认为其乘以任意非零常数时仍表达同一个坐标（归一化）。 变换矩阵的集合称为特殊欧式群special Euclidean Group:</p>
<script type="math/tex; mode=display">
SE(3)=\lbrace T=
\begin{bmatrix}
R & \bf{t}\\
\bf{ 0^{T}} & 1
\end{bmatrix}
\in \mathbb{R}^{4 \times 4} |
R \in SO(3), \bf{t} \in \mathbb{R}^{3} \rbrace</script><script type="math/tex; mode=display">
T^{-1}=
\begin{bmatrix}
R^{T} & -R^{T}{\bf t}\\
{\bf 0^{T}} & 1
\end{bmatrix}</script><p>定义了变化矩阵后，多次变换可以直接对变换矩阵直接相乘即可。</p>
<h2 id="旋转向量与欧拉角"><a href="#旋转向量与欧拉角" class="headerlink" title="旋转向量与欧拉角"></a>旋转向量与欧拉角</h2><p>一般来说视觉SLAM有旋转矩阵和平移向量就够了，一般也是用这样的方式表达。为了进行拓展，比如在航迹推算和组合导航中，通常用四元数来表述物体姿态。</p>
<p>旋转矩阵有9个元素但仅表示三个自由度，比较冗余，因此引入旋转向量(rotation vector)，方向为旋转轴，长度为转过的角度，又称为角轴或轴角（angle axis）。</p>
<p>旋转向量只有三个量，无约束，更加直观，但是旋转轴一般不容易得知，其中旋转向量和旋转矩阵的关系可以通过罗德里格斯公式得出（Rodrigues’ s Formula）：（假设旋转轴为$\bf{n}$，旋转角为$\theta$）</p>
<script type="math/tex; mode=display">
\begin{align*}
& R = \cos \theta {\bf I}+(1-\cos \theta){\bf n} {\bf n^{T}}+\sin \theta {\bf n^{\wedge}}\\
& \theta = \arccos(\frac{tr(R)-1}{2}) \\
& R{\bf n}=\bf{n} \quad特征值为1的特征向量
\end{align*}</script><p>欧拉角（Euler Angles）将旋转分解成三个方向上的转动，最常见的是Z-Y-X，即yaw-pitch-roll（偏航-俯仰-横滚），不同领域习惯不同。但是欧拉角会有万向锁问题（<a target="_blank" rel="noopener" href="https://krasjet.github.io/quaternion/bonus_gimbal_lock.pdf">gimbal lock</a>)，会在特定值丢失一个自由度，存在奇异性问题，因此欧拉角不适合插值和迭代。实际上，仅用三个实数表达旋转时，会不可避免地存在奇异性问题。视觉SLAM中一般不用欧拉角表达姿态，主要在人机交互中用。</p>
<h2 id="四元数（Quaternion）"><a href="#四元数（Quaternion）" class="headerlink" title="四元数（Quaternion）"></a>四元数（Quaternion）</h2><p>2D情况下，可以用单位复数表达旋转，$z=x+iy=\rho e^{i \theta}$，乘$i$代表转转90度。</p>
<p>3D情况下，类似地，四元数可作为复数地扩充。</p>
<p>四元数有三个虚部和一个实部，${\bf q}=q_{0}+q_{1}i+q_{2}j+q_{3}k$，虚部之间满足关系（自己和自己运算像复数，自己和别人运算像叉乘）:</p>
<script type="math/tex; mode=display">
\begin{cases}
i^{2}=j^{2}=k^{2}=-1 \\
ij=k,jk=-k \\
jk=i.kj=-i \\
ki=j,ik=-j
\end{cases}</script><p>单位四元数可以表达旋转，${\bf q}=q_{0}+q_{1}i+q_{2}j+q_{3}k=[s, {\bf v}], s=q_{0}\in \mathbb{R}, {\bf v}=[q_{1}, q_{2}, q_{3}]^{T}\in \mathbb{R}^{3}$，四元数有以下地运算规则：</p>
<script type="math/tex; mode=display">
{\bf q}_{a}+{\bf q}_{b}=[s_{a}\pm s_{b}, {\bf v}_{a}\pm {\bf v}_{b}]\\

\begin{align*}
{\bf q}_{a}{\bf q}_{b}= &s_{a}s_{b}-x_{a}x_{b}-y_{a}y_{b}-z_{a}z_{b}\\
& +(s_{a}x_{b}+x_{a}s_{b}+y_{a}z_{b}-z_{a}y_{b})i\\
& +(s_{a}y_{b}-x_{a}z_{b}+y_{a}s_{b}+z_{a}x_{b})j\\
& +(s_{a}z_{b}+x_{a}y_{b}-y_{b}x_{a}+z_{a}s_{b})k 
\end{align*}
\\
{\bf q}_{a}{\bf q}_{b}= [s_{a}s_{b}-{\bf v}_{a}^{T}{\bf v}_{b}, s_{a}{\bf v}_{b}+s_{b}{\bf v}_{a}+{\bf v}_{a} \times {\bf v}_{b}] \\

{\bf q}^{*}=s_{a}-x_{a}i-y_{a}j-z_{a}k=[s_{a}, -{\bf v}_{a}]\\

\left\| {\bf q}_{a} \right\|= \sqrt{s_{a}^{2}+x_{a}^{2}+y_{a}^{2}+z_{a}^{2}} \\

{\bf q}^{-1}={\bf q}^{*}/ \left\| {\bf q} \right\| ^{2}\\

k{\bf q}=[ks, k{\bf v}]\\

{\bf q}_{a} \cdot {\bf q}_{b}=s_{a}s_{b}+x_{a}x_{b}i+y_{a}y_{b}j+z_{a}z_{b}k</script><p>四元数到角轴：${\bf q}=[\cos \frac{\theta}{2},n_{x}\sin \frac{\theta}{2}, n_{y}\sin \frac{\theta}{2}, n_{z}\sin \frac{\theta}{2}]^{T}$。</p>
<p>角轴到四元数：$\theta =2 \arccos q_{0}, [n_{x}, n_{y}, n_{z}]^{T} = [q_{1}, q_{2}, q_{3}]^{T}/  \sin \frac{\theta}{2}$</p>
<p>三维点$p(x,y,z)$经过一次以${\bf q}$表示的旋转后，得到了$p^{‘}$，${\bf p}=[0,x,y,z]=[0, {\bf v}]$，旋转之后的关系为${\bf p}^{‘}={\bf q} {\bf p} {\bf q}^{-1}$。四元数相比与角轴和欧拉角，形式上更加紧凑，也无奇异性。</p>
<p><strong>值得注意的是，${\bf q}$和$-{\bf q}$表示同一个旋转。</strong></p>
<hr>
<p>学习四元数的一个最直观的问题就是为什么三个变量来描述三维旋转，诸如欧拉角会出现奇异性的情况，而用四个变量的四元数就不会？也就说用高维的东西描述低维的东西更加有效。</p>
<p>知乎上有相关的<a target="_blank" rel="noopener" href="https://www.zhihu.com/question/20962240/answer/33438846">回答</a>，写得还算不错，比较直观。不过依旧没有解决为什么三个变量描述三维旋转会出现奇异性的现象。</p>
<blockquote>
<p>利用四元数来对三维点的旋转进行操作，是通过纯四元数来进行的，即变换后的点可以表示为${\bf qwq^{-1} }$，这里的问题是为什么这种形式。（注意，这里的四元数是单位四元数）</p>
<p>汉密尔顿定义的性质：</p>
<p>1.运算产生的结果也要是三维向量<br>2.存在一个元运算，任何三维向量进行元运算的结果就是其本身<br>3.对于任何一个运算，都存在一个逆运算，这两个运算的积是元运算<br>4.运算满足结合律</p>
<p>其实，四元数有四个变量，完全可以被看作一个四维向量。单位四元数（norm=1）则存在于四维空间的一个球面上。${\bf q}_{a} {\bf q}_{b}$，四元数${\bf q}_{a}$乘以四元数${\bf q}_{b}$其实看作（1）对${\bf q}_{a}$进行${\bf q}_{b}$左旋转，或者（2）对${\bf q}_{b}$进行${\bf q}_{a}$右旋转。所以从始至终，四元数定义的都是四维旋转，而不是三维旋转！任意的四维旋转都可以唯一的拆分为一个左旋转和一个右旋转，表达出来就是${\bf q}_{L}{\bf p}{\bf q}_{R}$。这里，我们对四元数（四维向量）${\bf p}$进行了一个${\bf q}_{L}$左旋转和一个${\bf q}_{R}$右旋转。结果当然是一个四元数，符合性质1。这个运算也同时符合性质2，3，4。</p>
<p>为了进行三维旋转运算，汉密尔顿首先在四维空间里划出了一块三维空间。汉密尔顿定义了一种纯四元数（pure quaternion），其表达式为${\bf q}_{w}=(0,w_{x},w_{y},w_{z})$。纯四元数第一项为零，它存在于四维空间的三维超平面上，与三维空间中的三维向量一一对应。然后，就有了我们常见的${\bf q}  {\bf q}_{w} {\bf q}^{*}$这种左乘单位四元数，右乘其共轭的表达式。这个运算形式是为了限制其运算结果所在的空间。简单的说，当对一个三维向量进行三维旋转后，我们希望得到的是一个三维向量，而不是四维向量。</p>
<p>这也就解释了为什么四元数对应于角轴的关系式中是$\frac{\theta}{2}$，而不是$\theta$，这是因为${\bf q}$做的就是一个$\frac{\theta}{2}$的旋转，而${\bf q}^{-1}$也做了一个$\frac{\theta }{2}$的旋转。我们进行了两次旋转，而不是一次，这两次旋转的结果是一个旋转角为$\theta$的旋转。</p>
</blockquote>
<p>此外，还有一点是，四元数可以用2x2复数矩阵（特殊酉群）和4x4矩阵来描述，但是四元数之间不满足乘法交换律，即${\bf q}_{1} {\bf q}_{2} \ne {\bf q}_{2} {\bf q}_{1}$，但是二维平面里的复数相乘满足乘法交换律，这里我粗略地理解是，二维旋转只有角度，没有轴的概念，只有按照什么顺序旋转多少角度，因此先转$\theta$，再转$\alpha$，与先转$\alpha$，再转$\theta$的结果是一样的，但是四元数相乘不是，每次转都是有个旋转轴的，因此不可交换。</p>
<p>有关四元数，旋转，群的理解和证明，可以参考这篇<a target="_blank" rel="noopener" href="https://krasjet.github.io/quaternion/quaternion.pdf">文章</a></p>
<script type="math/tex; mode=display">
\begin {align*}
{\bf v}^{'} & = {\bf v}_{||}^{'} + {\bf v}_{\bot}^{'}={\bf v}_{||} + {\bf q} {\bf v}_{\bot}\\ 
            & = {\bf p} {\bf p}^{-1} {\bf v}_{\bot} + {\bf p} {\bf p} {\bf v}_{\bot}\\
            & = {\bf p} {\bf p}^{*} {\bf v}_{\bot} + {\bf p} {\bf p} {\bf v}_{\bot}\\
            & = {\bf p} {\bf v}_{||} {\bf p}^{*} + {\bf p} {\bf v}_{\bot} {\bf p}^{*}\\
            & = {\bf p} ({\bf v}_{||}+{\bf v}_{\bot}) {\bf p}^{*}\\
            & = {\bf p} {\bf v} {\bf p}^{*}\\
            & = {\bf v}_{||} + {\bf p}^{2} {\bf v}_{\bot}
\end{align*}
\\
{\bf q}=[\cos \theta, \sin \theta ({\bf u})], {\bf p}=[\cos \frac{\theta}{2}, \sin \frac{\theta}{2} ({\bf u})],{\bf q}={\bf p}^{2}</script><p><strong>对于平行的分量，变换完全抵消，对于垂直的分量，施加两次变换，这也就是为什么是</strong>$\frac {\theta}{2}$。</p>
<p><strong>四元数与群：</strong></p>
<p>单位四元数与 3D 旋转有一个<strong>2对1满射同态关系</strong>，或者说单位四元数<strong>双倍覆盖了3D旋转</strong>。因为这个映射是满射，我们可以说所有的单位四元数都对应着一个 3D 旋转。或者说，一个四维单位超球面（也叫做$\mathbb S^{3}$）上任意一点所对应的四元数（$∥q∥ = 1$）都对应着一个 3D 旋转。</p>
<p>四元数，旋转矩阵，群，geometric algebra都有着紧密的联系，因此可以先做好相关的功课，这里列出几篇阅读材料：</p>
<p><a target="_blank" rel="noopener" href="https://alistairsavage.ca/mat4144/notes/MAT4144-5158-LieGroups.pdf">Introduction to Lie Groups</a></p>
<p><a target="_blank" rel="noopener" href="http://www.jaapsuter.com/geometric-algebra.pdf">Geometric Algebra Primer</a></p>
<p><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?reload=9&amp;v=PNlgMPzj-7Q&amp;list=PLpzmRsG7u_gqaTo_vEseQ7U8KFvtiJY4K">youtube geometric algebra</a></p>
<blockquote>
<p><strong>A Quaternion is a scalar plus a bivector.</strong></p>
<p>Apart from the fact that quaternions have four components, there is nothing four-dimensional or imaginary about a quaternion. The first component is a scalar, and the other three components form the bivector-plane relative to which the rotation is performed.</p>
</blockquote>
<p>这似乎解释了之前我的疑问，为什么要用四个变量来描述三维，就是用得用高维的解释低维的，这里指出了四元数拥有四个变量，但是不是指四维或者虚数，而是通过标量和bivector的组合来描述旋转，几何代数的这种形式统一了不同维度的旋转，因此比较优雅。不过更深层次的东西和理解涉及到比较多的数学知识和空间理解，我暂时还达不到。。。。</p>
<hr>
<hr>
<h2 id="作业与实践"><a href="#作业与实践" class="headerlink" title="作业与实践"></a>作业与实践</h2><h3 id="熟悉Eigen运算"><a href="#熟悉Eigen运算" class="headerlink" title="熟悉Eigen运算"></a>熟悉Eigen运算</h3><p>对于线性方程组$Ax=b$，其中$A$是方阵。</p>
<p>1).什么条件下，$x$有解且唯一？</p>
<p>当矩阵$A$可逆的时候，也就是此时矩阵满秩。</p>
<p>2).高斯消元法原理</p>
<p>高斯消元法其实就是对系数矩阵作初等行变换，这不改变方程的解，将系数矩阵化成上三角矩阵的形式，然后从下往上依次解出方程组的每个分量解（回代）。如果是针对列主元的高斯消元法，需要加入方程组的右侧值，与系数矩阵组成增广矩阵，进而求解。</p>
<p>3). QR分解的原理</p>
<p>任意的$A \in {\bf C}^{n \times n}$都可以进行$QR$分解，即$A=QR$，$Q$为n阶酉矩阵($QQ^<br>{H}=I$)，$R$为n阶上三角矩阵。</p>
<p>$QR$分解与Gram-Schmidt正交化有关，即将$A$进行Gram-Schmidt正交化，化为$Q$，然后求出R。Q的列向量是A的列空间的标准正交基，R是一个非奇异可逆的上三角矩阵，即将矩阵每个列作为一个基本单元，将其化为正交的基向量与在这个基向量上的投影长度的积。</p>
<p>4).Cholesky分解的原理</p>
<p>Cholesky分解其实是矩阵Doolittle分解(三角分解的特例)的特例。三角分解是是将方针分解成同阶的下三角阵和上三角阵，其中上三角阵的主对角线元素全为1则为Doolittle分解。如果矩阵$A$既是方阵又是Hermite正定阵时($A=A^{H}$,且特征值全为正数)，则存在唯一分解$A=LL^{H}$，其中$L$是具有主对角元素为正数的下三角矩阵。</p>
<p>5).利用$QR$和Cholesky分解法分解随机矩阵$A \in {\bf C}^{100 \times 100}$求解$x$。</p>
<p>主要思路就是先用定义动态大小的矩阵，之后进行调用相关的函数处理。其中需要注意的是，Cholesky分解需要矩阵为正定阵，因此在矩阵定义上需要进行一些处理。</p>
<p>代码如下：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#include &lt;iostream&gt;</span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">#include &lt;ctime&gt;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; Eigen部分</span><br><span class="line">#include &lt;Eigen&#x2F;Core&gt;</span><br><span class="line">&#x2F;&#x2F;Eigen稠密矩阵的代数运算（逆和特征值等）</span><br><span class="line">#include &lt;Eigen&#x2F;Dense&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">int main (int argc, char** argv)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">Eigen::Matrix &lt;double,Eigen::Dynamic, Eigen::Dynamic&gt; matrix_dynamic; &#x2F;&#x2F;Eigen固定大小矩阵最大支持到50</span><br><span class="line">Eigen::Matrix&lt;double,Eigen::Dynamic, Eigen::Dynamic&gt; matrix_A;</span><br><span class="line">Eigen::Matrix&lt;double,Eigen::Dynamic, 1&gt; x;</span><br><span class="line">Eigen::Matrix&lt;double,Eigen::Dynamic,1&gt; v_right;</span><br><span class="line"></span><br><span class="line">matrix_dynamic &#x3D; Eigen::MatrixXd::Random(100,100); &#x2F;&#x2F;随机化取值</span><br><span class="line"></span><br><span class="line">matrix_A &#x3D; matrix_dynamic.transpose()*matrix_dynamic; &#x2F;&#x2F;cholesky分解需要A为正定矩阵</span><br><span class="line"></span><br><span class="line">v_right &#x3D; Eigen::MatrixXd::Random(100, 1); &#x2F;&#x2F;方程右边的值随机取值</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;QR Decomposition</span><br><span class="line">clock_t time_stt &#x3D; clock();</span><br><span class="line"></span><br><span class="line">x &#x3D; matrix_A.colPivHouseholderQr().solve(v_right);</span><br><span class="line">cout&lt;&lt;&quot;the time used in QR decomposition is &quot;&lt;&lt; 1000* (clock() - time_stt)&#x2F;(double) CLOCKS_PER_SEC&lt;&lt;&quot;ms&quot;&lt;&lt; endl;</span><br><span class="line">cout&lt;&lt;x&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;Cholesky Decomposition</span><br><span class="line">time_stt &#x3D; clock();</span><br><span class="line"></span><br><span class="line">x &#x3D; matrix_A.llt().solve(v_right);</span><br><span class="line">cout&lt;&lt;&quot;the time used in Cholesky decomposition is &quot;&lt;&lt; 1000* (clock() - time_stt)&#x2F;(double) CLOCKS_PER_SEC&lt;&lt;&quot;ms&quot;&lt;&lt; endl;</span><br><span class="line">cout&lt;&lt;x&lt;&lt;endl;</span><br><span class="line">return 0;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>CMakeLists.txt文件内容如下：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cmake_minimum_required(VERSION 2.8)</span><br><span class="line"></span><br><span class="line">project(QR_cholesky)</span><br><span class="line"></span><br><span class="line">set(CMAKE_BUILD_TYPE &quot;Release&quot;)</span><br><span class="line">set(CMAKE_CXX_FLAGS &quot;-O3&quot;) #Debug版会使用参数-g；Release版使用-O3 –DNDEBUG</span><br><span class="line"></span><br><span class="line">include_directories(&quot;&#x2F;usr&#x2F;include&#x2F;eigen3&quot;)</span><br><span class="line"></span><br><span class="line">add_executable(QR_cholesky QR_cholesky.cpp)</span><br><span class="line">#eigen3都是头文件，不需要target_link_libraries</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="几何运算练习"><a href="#几何运算练习" class="headerlink" title="几何运算练习"></a>几何运算练习</h3><p>基本思想就是$T_{cw} p=p^{‘}$，或者$R p + t=p^{‘}$，注意这里是世界坐标系的点变换到相机坐标系。</p>
<p>代码如下：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#include&lt;iostream&gt;</span><br><span class="line">#include&lt;cmath&gt;</span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;Eigen几何模块</span><br><span class="line">#include &lt;Eigen&#x2F;Core&gt;</span><br><span class="line">#include&lt;Eigen&#x2F;Geometry&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">int main(int argc, char** argv)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">Eigen::Quaterniond q1(0.55,0.3,0.2,0.2);</span><br><span class="line">q1 &#x3D; q1.normalized();</span><br><span class="line"></span><br><span class="line">Eigen::Quaterniond q2(-0.1,0.3,-0.7,0.2);</span><br><span class="line">q2 &#x3D; q2.normalized();</span><br><span class="line"></span><br><span class="line">Eigen::Matrix &lt;double, 3,1&gt; t1;</span><br><span class="line">t1 &lt;&lt; 0.7,1.1,0.2;</span><br><span class="line"></span><br><span class="line">Eigen::Matrix &lt;double, 3,1&gt; t2;</span><br><span class="line">t2 &lt;&lt; -0.1,0.4,0.8;</span><br><span class="line"></span><br><span class="line">Eigen::Matrix &lt;double, 3,1&gt; p1;</span><br><span class="line">p1 &lt;&lt; 0.5,-0.1,0.2;</span><br><span class="line"></span><br><span class="line">Eigen::Matrix &lt;double, 3,1&gt; p2;</span><br><span class="line"></span><br><span class="line">Eigen::Matrix &lt;double, 3,1&gt; p; &#x2F;&#x2F;世界坐标系的点</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;利用变换矩阵的方法</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; Eigen::Isometry3d Tcw1 &#x3D; Eigen::Isometry3d::Identity();&#x2F;&#x2F;变换矩阵1</span><br><span class="line">&#x2F;&#x2F; Tcw1.rotate(q1);</span><br><span class="line">&#x2F;&#x2F; Tcw1.pretranslate(t1);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; Eigen::Isometry3d Tcw2 &#x3D; Eigen::Isometry3d::Identity();&#x2F;&#x2F;变换矩阵2</span><br><span class="line">&#x2F;&#x2F; Tcw2.rotate(q2);</span><br><span class="line">&#x2F;&#x2F; Tcw2.pretranslate(t2);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; p &#x3D; Tcw1.inverse()*p1;</span><br><span class="line">&#x2F;&#x2F; p2 &#x3D; Tcw2*p;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;直接利用旋转矩阵和平移向量进行组合运算</span><br><span class="line">Eigen::Matrix&lt;double,3,3&gt; R1_inverse;</span><br><span class="line">R1_inverse &#x3D; q1.matrix().inverse();</span><br><span class="line"></span><br><span class="line">Eigen::Matrix&lt;double,3,3&gt; R2;</span><br><span class="line">R2 &#x3D; q2.matrix();</span><br><span class="line"></span><br><span class="line">p2 &#x3D; R2 * R1_inverse *(p1 - t1) + t2;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cout &lt;&lt; &quot;p2 &#x3D; &quot; &lt;&lt; p2.transpose() &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">return 0;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>CMakeLists.txt文件内容如下：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cmake_minimum_required(VERSION 2.8)</span><br><span class="line">set (CMAKE_BUILD_TYPE &quot;Release&quot;)</span><br><span class="line">set (CMAKE_CXX_FLAGS &quot;-O3&quot;)</span><br><span class="line"></span><br><span class="line">project(Geometryusing)</span><br><span class="line">include_directories(&quot;&#x2F;usr&#x2F;include&#x2F;eigen3&quot;)</span><br><span class="line"></span><br><span class="line">add_executable(Geometryusing Geometryusing.cpp)</span><br><span class="line">#eigen3都是头文件，不需要target_link_libraries</span><br></pre></td></tr></table></figure>
<h3 id="旋转的表达"><a href="#旋转的表达" class="headerlink" title="旋转的表达"></a>旋转的表达</h3><p>1).旋转矩阵的正交性</p>
<p>坐标系中的某个单位正交基$(e_{1},e_{2},e_{3})$经过旋转变换后变为$(e^{‘}_{1},e^{‘}_{2},e^{‘}_{3})$，对于同一个向量在两个坐标系下的坐标分别为$a(a_{1},a_{2},a_{3})$和$(a^{‘}_{1},a^{‘}_{2},a^{‘}_{3})$，由于向量不会随着坐标系的旋转而发生变化，则有：</p>
<script type="math/tex; mode=display">
\begin{bmatrix}
e_{1} & e_{2} & e_{3}
\end {bmatrix}
\begin{bmatrix}
a_{1} \\
a_{2} \\
a_{3}
\end {bmatrix}
=
\begin{bmatrix}
e^{'}_{1} & e^{'}_{2} & e^{'}_{3}
\end {bmatrix}
\begin{bmatrix}
a^{'}_{1} \\
a^{'}_{2} \\
a^{'}_{3}
\end {bmatrix}</script><p>等式两边同时左乘$[e^{T}_{1} \quad e^{T}_{2} \quad e^{T}_{3}]$，则得出旋转矩阵$R$为</p>
<script type="math/tex; mode=display">
R=
\begin{bmatrix}
e^{T}_{1}\\
e^{T}_{2} \\
e^{T}_{3}
\end{bmatrix}
\begin{bmatrix}
e^{'}_{1} & e^{'}_{2} & e^{'}_{3}
\end{bmatrix}</script><p>则有：</p>
<script type="math/tex; mode=display">
R^{T}R=
\begin{bmatrix}
e^{'}_{1}\\
e^{'}_{2}\\
e^{'}_{3}
\end{bmatrix}
\begin{bmatrix}
e^{T}_{1} & e^{T}_{2} & e^{T}_{2}
\end{bmatrix}
\begin{bmatrix}
e^{T}_{1}\\
e^{T}_{2} \\
e^{T}_{3}
\end{bmatrix}
\begin{bmatrix}
e^{'}_{1} & e^{'}_{2} & e^{'}_{3}
\end{bmatrix}
=I</script><script type="math/tex; mode=display">
\det R=
\det(
\begin{bmatrix}
e^{T}_{1}\\
e^{T}_{2} \\
e^{T}_{3}
\end{bmatrix}
\begin{bmatrix}
e^{'}_{1} & e^{'}_{2} & e^{'}_{3}
\end{bmatrix}
)
=
det(\begin{bmatrix}
e^{T}_{1}\\
e^{T}_{2} \\
e^{T}_{3}
\end{bmatrix})
det(\begin{bmatrix}
e^{'}_{1} & e^{'}_{2} & e^{'}_{3}
\end{bmatrix})
=1</script><p>2).四元数的维度</p>
<p>易知$\varepsilon$是三维，$\eta$是一维的。</p>
<p>3).四元数相关证明(题目应该有错）</p>
<p>符号$x$和$\wedge$代表着反对称矩阵，代表着向量到反对称矩阵的变换，这是从叉乘引申而来的。即</p>
<script type="math/tex; mode=display">
a^{\times}=
(\begin{bmatrix}
a_{1}\\
a_{2}\\
a_{3}
\end{bmatrix})^{\times}
=
\begin{bmatrix}
0 & -a_{3} & a_{2}\\
a_{3} & 0 &-a_{1}\\
-a_{2} & a_{1} & 0
\end{bmatrix}</script><p>设$q_{1}=[x_{1},y_{1},z_{1},w_{1}]^{T}$,$q_{2}=[x_{2},y_{2},z_{2},w_{2}]^{T}$,</p>
<script type="math/tex; mode=display">
\begin{align*}
q_{1}q_{2} & = w_{1}w_{2}-x_{1}x_{2}-y_{1}y_{2}-z_{1}z_{2}\\
     & + (w_{1}x_{2}+x_{1}w_{2}+y_{1}z_{2}-z_{1}y_{2})i\\
     & + (w_{1}y_{2}-x_{1}z_{2}+y_{1}w_{2}+z_{1}x_{2})j\\
     & + (w_{1}z_{2}+x_{1}y_{2}-y_{1}x_{2}+z_{1}w_{2})k
\end{align*}</script><script type="math/tex; mode=display">
q_{1}^{\bigoplus}q_{2}=
\begin{bmatrix}
 w_{1} & -z_{1} & y_{1} & x_{1}\\
 z_{1} & w_{1} & -x_{1} & y_{1}\\
 -y_{1} & x_{1} & w_{1} & z_{1}\\
 -x_{1} & -y_{1} & -z_{1} & w_{1}
\end{bmatrix}
\begin{bmatrix}
x_{2}\\
y_{2}\\
z_{2}\\
w_{2}
\end{bmatrix}
=
\begin{bmatrix}
w_{1}x_{2}-z_{1}y_{2}+y_{1}z_{2}+x_{1}w_{2}\\
z_{1}x_{2}+w_{1}y_{2}-x_{1}z_{2}+y_{1}w_{2}\\
-x_{2}y_{1}+x_{1}y_{2}+w_{1}z_{2}+z_{1}w_{2}\\
w_{1}w_{2}-x_{1}x_{2}-y_{1}y_{2}-z_{1}z_{2}
\end{bmatrix}
\begin{align*}
 & = w_{1}w_{2}-x_{1}x_{2}-y_{1}y_{2}-z_{1}z_{2}\\
     & + (w_{1}x_{2}+x_{1}w_{2}+y_{1}z_{2}-z_{1}y_{2})i\\
     & + (w_{1}y_{2}-x_{1}z_{2}+y_{1}w_{2}+z_{1}x_{2})j\\
     & + (w_{1}z_{2}+x_{1}y_{2}-y_{1}x_{2}+z_{1}w_{2})k
\end{align*}
=q_{1}q_{2}</script><script type="math/tex; mode=display">
q_{2}^{+}q_{1}=
\begin{bmatrix}
 w_{2} & z_{2} & -y_{2} & x_{2}\\
 -z_{2} & w_{2} & x_{2} & y_{2}\\
 y_{2} & -x_{2} & w_{2} & z_{2}\\
 -x_{2} & -y_{2} & -z_{2} & w_{2}
\end{bmatrix}
\begin{bmatrix}
x_{1}\\
y_{1}\\
z_{1}\\
w_{1}
\end{bmatrix}
=
\begin{bmatrix}
w_{2}x_{1}+y_{1}z_{2}-y_{2}z_{1}+w_{1}x_{2}\\
-x_{1}z_{2}+w_{2}y_{1}+x_{2}z_{1}+y_{2}w_{1}\\
x_{1}y_{2}-x_{2}y_{1}+w_{2}z_{1}+w_{1}z_{2}\\
w_{1}w_{2}-x_{1}x_{2}-y_{1}y_{2}-z_{1}z_{2}
\end{bmatrix}
\begin{align*}
 & = w_{1}w_{2}-x_{1}x_{2}-y_{1}y_{2}-z_{1}z_{2}\\
     & + (w_{1}x_{2}+x_{1}w_{2}+y_{1}z_{2}-z_{1}y_{2})i\\
     & + (w_{1}y_{2}-x_{1}z_{2}+y_{1}w_{2}+z_{1}x_{2})j\\
     & + (w_{1}z_{2}+x_{1}y_{2}-y_{1}x_{2}+z_{1}w_{2})k
\end{align*}
=q_{1}q_{2}</script><h3 id="罗德里格斯公式证明"><a href="#罗德里格斯公式证明" class="headerlink" title="罗德里格斯公式证明"></a>罗德里格斯公式证明</h3><p><img src="https://cdn.jsdelivr.net/gh/Richardyu114/PicBed_blog/visualSLAMbyGaoxiang-2/Rodrigues1.png" alt="旋转分解"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Richardyu114/PicBed_blog/visualSLAMbyGaoxiang-2/Rodrigues2.png" alt="分解的表达"></p>
<p>如上图所示，向量${\bf v}$绕单位旋转轴${\bf k}$旋转$\theta$角后，变换成了${\bf v}_{rot}$，分别将向量${\bf v}$和${\bf v}_{rot}$沿${\bf k}$平行和垂直的方向分解。</p>
<script type="math/tex; mode=display">
\begin{align*}
&{\bf v}={\bf v}_{||}+{\bf v}_{\bot}\\
&{\bf v}_{||}=({\bf v} \cdot {\bf k}){\bf k}\\
& {\bf v}_{\bot}={\bf v}-{\bf v}_{||}=-{\bf k}\times({\bf k} \times {\bf v})
\end{align*}</script><p>根据图像，我们知道，平行于旋转轴的分量没有变化，只有垂直于旋转轴的分量进行了旋转，而且它们的模长是一样的，这就说明${\bf v}_{\bot}$和${\bf v}_{rot \bot}$是在一个圆上，长度相等，而且，${\bf v}_{\bot}$和${\bf k} \times {\bf v}_{\bot}$构成了该圆的两个正交坐标轴，因此${\bf v}_{rot \bot}$的坐标可以用这个坐标轴表示，或者说该向量可以被这两个正交坐标基线性表示，即：</p>
<script type="math/tex; mode=display">
\begin{align*}
{\bf v}_{rot \bot}&=\cos \theta{\bf v}_{\bot}+\sin \theta({\bf k}\times {\bf v}_{\bot})\\
                  &=\cos \theta{\bf v}_{\bot}+\sin \theta({\bf k} \times {\bf v}-{\bf k} \times {\bf v}_{||})\\
                  &=\cos \theta{\bf v}_{\bot}+\sin \theta({\bf k}\times {\bf v})
\end{align*}</script><script type="math/tex; mode=display">
\begin{align*}
{\bf v}_{rot} & = {\bf v}_{rot ||}+{\bf v}_{rot \bot}\\
              & = {\bf v}_{||}+\cos \theta {\bf v}_{\bot}+\sin \theta ({\bf k}\times{\bf v})\\
              & = {\bf v}_{||}+\cos \theta({\bf v}-{\bf v}_{||}) +\sin \theta ({\bf k}\times{\bf v})\\
              & = \cos \theta {\bf v}+(1-\cos \theta){\bf v}_{||}+\sin \theta ({\bf k}\times{\bf v})\\
              & = \cos \theta {\bf v}+(1-\cos \theta)({\bf k}\cdot {\bf v}){\bf k}+\sin \theta ({\bf k}\times{\bf v})
\end{align*}</script><p>下面将这些向量都看成矩阵的形式，将其运算化为矩阵的运算形式，假设${\bf k}$和${\bf v}$都是列向量的形式，则${\bf k}({\bf k}\cdot {\bf v})=kk^{T}v$，${\bf k}\times {\bf v}=k^{\wedge}v$，因此，得到了旋转矩阵的形式为：</p>
<script type="math/tex; mode=display">
R=\cos \theta I+(1-\cos \theta)kk^{T}+\sin \theta k^{\wedge}</script><p>将$k$换成$n$即得罗德里格斯公式。</p>
<h3 id="四元数运算性质的验证"><a href="#四元数运算性质的验证" class="headerlink" title="四元数运算性质的验证"></a>四元数运算性质的验证</h3><p>设单位四元数$q=[\varepsilon \quad \eta]$(虚部 实部），点$p=[\zeta \quad 0]$，$q=x_{1}i+y_{1}j+z_{1}k+w_{1}, w_{1}^{2}+x_{1}^{2}+y_{1}^{2}+z_{1}^{2}=1$则：</p>
<script type="math/tex; mode=display">
\begin{align*}
p^{'}=qpq^{-1} & = q^{\bigoplus}pq^{-1}\\
               & = q^{\bigoplus}q^{-1+}p\\
               & = \begin{bmatrix}
               \eta I+\varepsilon ^{\times} & \varepsilon \\
               -\varepsilon^{T} & \eta
               \end{bmatrix}
               \begin{bmatrix}
               \eta I-(-\varepsilon )^{\times} & -\varepsilon \\
               -(-\varepsilon)^{T} & \eta
               \end{bmatrix}
               \begin{bmatrix}
               \zeta\\
               0
               \end{bmatrix}
               \\
               & = \begin{bmatrix}
               w_{1} & -z_{1} & y_{1} & x_{1} \\
               z_{1} & w_{1} & -x_{1} & y_{1} \\
               -y_{1} & x_{1} & w_{1} & z_{1}\\
               -x_{1} & -y_{1} & -z_{1} & w_{1}
               \end{bmatrix}
               \begin{bmatrix}
               w_{1} & -z_{1} & y_{1} & -x_{1} \\
               z_{1} & w_{1} & -x_{1} & -y_{1} \\
               -y_{1} & x_{1} & w_{1} & -z_{1}\\
               x_{1} & y_{1} & z_{1} & w_{1}
               \end{bmatrix}
               \begin{bmatrix}
               \zeta \\
               0
               \end{bmatrix}
               \\
               & = \begin{bmatrix}
               R_{3 \times 3} & 0_{3 \times 1}\\
               0_{1 \times 3} & 1
               \end{bmatrix}
               \begin{bmatrix}
               \zeta \\
               0
               \end{bmatrix}
\end{align*}</script><p>易知$p^{‘}$的实部为0，也就是上述形式限制了点的变换维度，虽然四元数是四个变量，但是不会把三维点变到四维去。</p>
<p>计算得出旋转矩阵$R$为:</p>
<script type="math/tex; mode=display">
R=
\begin{bmatrix}
w_{1}^{2}+x_{1}^{2}-y_{1}^{2}-z_{1}^{2} & 2x_{1}y_{1}-2w_{1}z_{1} & 2x_{1}z_{1}+2y_{1}w_{1}\\
2x_{1}y_{1}+2z_{1}w_{1} & w_{1}^{2}+y_{1}^{2}-x_{1}^{2}-z_{1}^{2} & 2y_{1}z_{1}-2x_{1}w_{1}\\
2x_{1}z_{1}-2y_{1}w_{1} & 2y_{1}z_{1}+2x_{1}w_{1} & w_{1}^{2}+z_{1}^{2}-x_{1}^{2}y_{1}^{2}
\end{bmatrix}</script><h3 id="C-11"><a href="#C-11" class="headerlink" title="C++11"></a><a target="_blank" rel="noopener" href="https://blog.csdn.net/sinat_35297665/article/details/80101460">C++11</a></h3><ul>
<li>for(atuo&amp; a: avec)</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/hailong0715/article/details/54172848/">范围for循环</a>，用a遍历avec中的每个量；基于范围的FOR循环的遍历是只读的遍历，除非将变量变量的类型声明为引用类型。</p>
<ul>
<li>for(atuo&amp; a: avec)</li>
</ul>
<p>自动类型推导，根据a获得的值，用auto自动推断出a的类型；</p>
<ul>
<li><a href="const A&amp;a1,const A&amp;a2"></a>{return a1.index&lt;a2.index;})</li>
</ul>
<p>运用了<a target="_blank" rel="noopener" href="https://www.cnblogs.com/DswCnblog/p/5629165.html">lambda表达式</a>。</p>
<ul>
<li>begin()</li>
</ul>
<p><strong>begin</strong> 返回首元素的地址，<strong>end</strong> 返回尾元素的下一个地址。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Richard YU</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://densecollections.top/posts/visualSLAMbyGaoxiang-2/">http://densecollections.top/posts/visualSLAMbyGaoxiang-2/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://densecollections.top" target="_blank">自拙集</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/visual-SLAM/">visual SLAM</a><a class="post-meta__tags" href="/tags/Linux/">Linux</a><a class="post-meta__tags" href="/tags/C-11/">C++11</a><a class="post-meta__tags" href="/tags/Computer-vision/">Computer vision</a><a class="post-meta__tags" href="/tags/Eigen/">Eigen</a></div><div class="post_share"><div class="addthis_inline_share_toolbox"></div><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5ff01204250e8048" async="async"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/visualSLAMbyGaoxiang-3/"><img class="prev-cover" src="https://images.unsplash.com/photo-1602911310162-4d8c235c095b?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&amp;ixlib=rb-1.2.1&amp;auto=format&amp;fit=crop&amp;w=634&amp;q=80" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">visual SLAM by Gaoxiang(3)</div></div></a></div><div class="next-post pull-right"><a href="/posts/visualSLAMbyGaoxiang-1/"><img class="next-cover" src="https://images.unsplash.com/photo-1595769393754-418cb8bf6b14?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&amp;ixlib=rb-1.2.1&amp;auto=format&amp;fit=crop&amp;w=1355&amp;q=80" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">visual SLAM by Gaoxiang(1)</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/visualSLAMbyGaoxiang-1/" title="visual SLAM by Gaoxiang(1)"><img class="cover" src="https://images.unsplash.com/photo-1595769393754-418cb8bf6b14?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=1355&q=80" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-03-12</div><div class="title">visual SLAM by Gaoxiang(1)</div></div></a></div><div><a href="/posts/visualSLAMbyGaoxiang-3/" title="visual SLAM by Gaoxiang(3)"><img class="cover" src="https://images.unsplash.com/photo-1602911310162-4d8c235c095b?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=634&q=80" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-03-26</div><div class="title">visual SLAM by Gaoxiang(3)</div></div></a></div><div><a href="/posts/houjieC++/" title="侯捷C++面向对象程序设计"><img class="cover" src="https://images.unsplash.com/photo-1604432952064-38b878fda1bd?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=635&q=80" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-05-28</div><div class="title">侯捷C++面向对象程序设计</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside_content" id="aside_content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/Richardyu114/PicBed_blog/others/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Richard YU</div><div class="author-info__description">Today everything exists to end in a photograph</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">25</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">54</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">12</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Richardyu114"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://twitter.com/Yu1145635107" target="_blank" title="Twitter"><i class="fab fa-twitter"></i></a><a class="social-icon" href="https://instagram.com/d.h.richard" target="_blank" title="Instagram"><i class="fab fa-instagram-square"></i></a><a class="social-icon" href="https://weibo.com/u/5211687990" target="_blank" title="Weibo"><i class="fab fa-weibo"></i></a><a class="social-icon" href="https://www.douban.com/people/161993653/" target="_blank" title="豆瓣"><i class="fas fa-bookmark"></i></a></div></div></div><div class="card-widget card-announcement"><div class="card-content"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">2021-1-2, New Theme!</div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="card-content"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%82%B9%E4%B8%8E%E5%9D%90%E6%A0%87%E7%B3%BB"><span class="toc-number">1.</span> <span class="toc-text">点与坐标系</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%8B%E8%BD%AC%E7%9F%A9%E9%98%B5"><span class="toc-number">2.</span> <span class="toc-text">旋转矩阵</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%8B%E8%BD%AC%E5%90%91%E9%87%8F%E4%B8%8E%E6%AC%A7%E6%8B%89%E8%A7%92"><span class="toc-number">3.</span> <span class="toc-text">旋转向量与欧拉角</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E5%85%83%E6%95%B0%EF%BC%88Quaternion%EF%BC%89"><span class="toc-number">4.</span> <span class="toc-text">四元数（Quaternion）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%9C%E4%B8%9A%E4%B8%8E%E5%AE%9E%E8%B7%B5"><span class="toc-number">5.</span> <span class="toc-text">作业与实践</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%86%9F%E6%82%89Eigen%E8%BF%90%E7%AE%97"><span class="toc-number">5.1.</span> <span class="toc-text">熟悉Eigen运算</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%A0%E4%BD%95%E8%BF%90%E7%AE%97%E7%BB%83%E4%B9%A0"><span class="toc-number">5.2.</span> <span class="toc-text">几何运算练习</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%8B%E8%BD%AC%E7%9A%84%E8%A1%A8%E8%BE%BE"><span class="toc-number">5.3.</span> <span class="toc-text">旋转的表达</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%97%E5%BE%B7%E9%87%8C%E6%A0%BC%E6%96%AF%E5%85%AC%E5%BC%8F%E8%AF%81%E6%98%8E"><span class="toc-number">5.4.</span> <span class="toc-text">罗德里格斯公式证明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9B%E5%85%83%E6%95%B0%E8%BF%90%E7%AE%97%E6%80%A7%E8%B4%A8%E7%9A%84%E9%AA%8C%E8%AF%81"><span class="toc-number">5.5.</span> <span class="toc-text">四元数运算性质的验证</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#C-11"><span class="toc-number">5.6.</span> <span class="toc-text">C++11</span></a></li></ol></li></ol></div></div></div><div class="card-widget card-recent-post"><div class="card-content"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/ssd-refinedet-paper/" title="SSD-RefineDet论文阅读"><img src="https://images.unsplash.com/photo-1595769393754-418cb8bf6b14?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&amp;ixlib=rb-1.2.1&amp;auto=format&amp;fit=crop&amp;w=1355&amp;q=80" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SSD-RefineDet论文阅读"/></a><div class="content"><a class="title" href="/posts/ssd-refinedet-paper/" title="SSD-RefineDet论文阅读">SSD-RefineDet论文阅读</a><time datetime="2020-08-03T13:25:33.000Z" title="发表于 2020-08-03 21:25:33">2020-08-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/houjieC++STL/" title="侯捷c++STL体系结构与内核分析"><img src="https://images.unsplash.com/photo-1606870655612-8eacd813984d?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&amp;ixlib=rb-1.2.1&amp;auto=format&amp;fit=crop&amp;w=1350&amp;q=80" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="侯捷c++STL体系结构与内核分析"/></a><div class="content"><a class="title" href="/posts/houjieC++STL/" title="侯捷c++STL体系结构与内核分析">侯捷c++STL体系结构与内核分析</a><time datetime="2020-06-12T08:24:02.000Z" title="发表于 2020-06-12 16:24:02">2020-06-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/yolopaperreading/" title="yolo系列论文阅读笔记"><img src="https://images.unsplash.com/photo-1608153498891-e895052f0cbe?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&amp;ixlib=rb-1.2.1&amp;auto=format&amp;fit=crop&amp;w=1350&amp;q=80" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="yolo系列论文阅读笔记"/></a><div class="content"><a class="title" href="/posts/yolopaperreading/" title="yolo系列论文阅读笔记">yolo系列论文阅读笔记</a><time datetime="2020-06-04T01:53:54.000Z" title="发表于 2020-06-04 09:53:54">2020-06-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/houjieC++/" title="侯捷C++面向对象程序设计"><img src="https://images.unsplash.com/photo-1604432952064-38b878fda1bd?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&amp;ixlib=rb-1.2.1&amp;auto=format&amp;fit=crop&amp;w=635&amp;q=80" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="侯捷C++面向对象程序设计"/></a><div class="content"><a class="title" href="/posts/houjieC++/" title="侯捷C++面向对象程序设计">侯捷C++面向对象程序设计</a><time datetime="2020-05-28T08:48:27.000Z" title="发表于 2020-05-28 16:48:27">2020-05-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/loopdetectioninBipartitegraph/" title="二分图搜无向定长环"><img src="https://images.unsplash.com/photo-1604432952064-38b878fda1bd?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&amp;ixlib=rb-1.2.1&amp;auto=format&amp;fit=crop&amp;w=635&amp;q=80" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="二分图搜无向定长环"/></a><div class="content"><a class="title" href="/posts/loopdetectioninBipartitegraph/" title="二分图搜无向定长环">二分图搜无向定长环</a><time datetime="2020-05-08T02:41:32.000Z" title="发表于 2020-05-08 10:41:32">2020-05-08</time></div></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(https://images.unsplash.com/photo-1608488426085-c8b7e9e4592f?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&amp;ixlib=rb-1.2.1&amp;auto=format&amp;fit=crop&amp;w=1351&amp;q=80)"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2021 By Richard YU</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">It's hard to tell that the world we live in is either a reality or a dream.</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="rightside.chat_btn"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',()=> {preloader.endLoading()})</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    loader: {
      source: {
        '[tex]/amsCd': '[tex]/amscd'
      }
    },
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        addClass: [200,() => {
          document.querySelectorAll('mjx-container:not([display=\'true\']').forEach( node => {
            const target = node.parentNode
            if (!target.classList.contains('has-jax')) {
              target.classList.add('mathjax-overflow')
            }
          })
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>function loadValine () {
  function initValine () {
    let initData = {
      el: '#vcomment',
      appId: 'duGoywhUmLrx9pM6qQhmf47c-gzGzoHsz',
      appKey: 'm7fc8w4Di5qnAXXaJ5Gp3Pgg',
      placeholder: '欢迎评论！请留下你的邮箱',
      avatar: 'robohash',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'en',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
    }

    if (true) { 
      initData.requiredFields= ('nick,mail'.split(','))
    }
    
    if (false) {
      const otherData = false
      initData = Object.assign({}, initData, otherData)
    }
    
    const valine = new Valine(initData)
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !true) {
  if (true) btf.loadComment(document.querySelector('#vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><div class="app-refresh" id="app-refresh"> <div class="app-refresh-wrap"> <label>✨ 網站已更新最新版本 👉</label> <a href="javascript:void(0)" onclick="location.reload()">點擊刷新</a> </div></div><script>function showNotification(){if(GLOBAL_CONFIG.Snackbar){var t="light"===document.documentElement.getAttribute("data-theme")?GLOBAL_CONFIG.Snackbar.bgLight:GLOBAL_CONFIG.Snackbar.bgDark,e=GLOBAL_CONFIG.Snackbar.position;Snackbar.show({text:"已更新最新版本",backgroundColor:t,duration:5e5,pos:e,actionText:"點擊刷新",actionTextColor:"#fff",onActionClick:function(t){location.reload()}})}else{var o=`top: 0; background: ${"light"===document.documentElement.getAttribute("data-theme")?"#49b1f5":"#1f1f1f"};`;document.getElementById("app-refresh").style.cssText=o}}"serviceWorker"in navigator&&(navigator.serviceWorker.controller&&navigator.serviceWorker.addEventListener("controllerchange",function(){showNotification()}),window.addEventListener("load",function(){navigator.serviceWorker.register("/sw.js")}));</script><script>(function(d, w, c) {
    w.ChatraID = 'PKLgJqFMRc6cPguup';
    var s = d.createElement('script');
    w[c] = w[c] || function() {
        (w[c].q = w[c].q || []).push(arguments);
    };
    s.async = true;
    s.src = 'https://call.chatra.io/chatra.js';
    if (d.head) d.head.appendChild(s);
})(document, window, 'Chatra');

if (true) {
  var chatBtnFn = () => {
    var chatBtn = document.getElementById("chat_btn")
    chatBtn.addEventListener("click", function(){
      Chatra('openChat')
    });
  }
  chatBtnFn()
} else {
  if (false) {
    function chatBtnHide () {
      Chatra('hide')
    }
    function chatBtnShow () {
      Chatra('show')
    }
  }
}</script><script>(function(){
  const bp = document.createElement('script');
  const curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  bp.dataset.pjax = ''
  const s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})()</script></div></body></html>